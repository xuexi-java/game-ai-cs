# 数据库配置
# 开发环境使用 Docker 容器（宿主机端口 22001）
DATABASE_URL="postgresql://postgres:postgres@localhost:22001/game_ai_cs?schema=public"

# 生产环境示例（宿主机端口 22002）
# DATABASE_URL="postgresql://cs_app:your-password@localhost:22002/cs_prod_db?schema=public"

# JWT 配置
JWT_SECRET="KQnYxA8fQvF6E3W2kC7m0nJ9XH2Zs5PpU8bQwR4dE="
JWT_EXPIRES_IN="8h"

# Redis 配置
REDIS_URL="redis://localhost:6379"
# REDIS_HOST="localhost"
# REDIS_PORT=6379
REDIS_MAX_RETRIES_PER_REQUEST=3
REDIS_MAX_RECONNECT_ATTEMPTS=5
REDIS_RETRY_DELAY_BASE=200
REDIS_RETRY_DELAY_MAX=2000
REDIS_CONNECT_TIMEOUT=5000
REDIS_PING_TIMEOUT=2000
METRICS_KEY="change-me"

# Cache
CACHE_ENABLED=true
CACHE_JITTER_PCT=0.1
CACHE_CONFIG_TTL_SECONDS=900
CACHE_QUICK_REPLY_TTL_SECONDS=60
DASHBOARD_CACHE_TTL_SECONDS=60
DASHBOARD_SNAPSHOT_TTL_SECONDS=300
DASHBOARD_DEGRADED_TTL_SECONDS=300
DASHBOARD_DEGRADE_EVENT_LOOP_MS=200
DASHBOARD_DEGRADE_CPU_LOAD_RATIO=1.2
DASHBOARD_DEGRADE_QUERY_MS=1500
DASHBOARD_DEGRADED=false

# 服务器配置
PORT=21001
NODE_ENV="development"

# 日志配置
# LOG_LEVEL: DEBUG | INFO | WARN | ERROR
# 开发环境建议 DEBUG，生产环境建议 INFO
LOG_LEVEL="INFO"

# 日志采样率 (0.0-1.0)，仅对成功且快速的请求生效
LOG_SAMPLING_RATE="0.1"

# 日志批量写入配置
LOG_BATCH_SIZE=100
LOG_BATCH_INTERVAL=100

# 内存队列保护（防止内存溢出）
LOG_MAX_QUEUE_SIZE=10000

# 日志压缩归档配置
LOG_ENABLE_COMPRESSION=true
LOG_ARCHIVE_AFTER_DAYS=7
LOG_CLEAN_AFTER_DAYS=30

# Redis 日志缓冲配置（可选，默认关闭）
LOG_USE_REDIS_BUFFER=false
LOG_REDIS_KEY=system:logs:buffer
LOG_REDIS_MAX_SIZE=10000

# 前端 URL（支持多个，用逗号分隔）
FRONTEND_URL="http://localhost:20001,http://localhost:20002"
# 开发环境默认 CORS 允许的域名（用逗号分隔）
# CORS_DEFAULT_DEV_ORIGINS="http://localhost:20101,http://localhost:20102,http://127.0.0.1:20101,http://127.0.0.1:20102"

# 文件上传配置
UPLOAD_DIR="./uploads"
MAX_FILE_SIZE=10485760

# Dify API 配置（默认配置，实际使用游戏配置覆盖）
DIFY_API_KEY=default-api-key
DIFY_BASE_URL=http://ai.sh7road.com/v1

# 百度翻译 API 配置
BAIDU_TRANSLATE_APP_ID=20250311002299702
BAIDU_TRANSLATE_SECRET=H1dETwWWqk45uN2DzGxK
# BAIDU_TRANSLATE_API_URL="https://fanyi-api.baidu.com/api/trans/vip/translate"  
# BAIDU_TRANSLATE_TIMEOUT=30000

# ==================== WebSocket 配置 ====================

# 心跳检测配置
WS_HEARTBEAT_CHECK_INTERVAL=15000
WS_HEARTBEAT_MAX_MISSED=3
WS_HEARTBEAT_PING_TIMEOUT=15000

# WebSocket 状态 TTL（秒）
WS_STATE_TTL=86400

# WebSocket 限流配置
WS_PLAYER_RATE_LIMIT=200
WS_AGENT_RATE_LIMIT=600
WS_PLAYER_BURST=20
WS_AGENT_BURST=60
WS_RATE_LIMIT_NOTICE_COOLDOWN=1000

# ==================== 队列服务配置 ====================

# 队列重试配置
QUEUE_RETRY_DELAY_BASE=1000
QUEUE_RETRY_DELAY_MAX=4000
QUEUE_MAX_RETRIES=3

# ==================== 限流配置 ====================

# 全局限流（每分钟）
THROTTLE_GLOBAL_TTL=60000
THROTTLE_GLOBAL_LIMIT=200

# Dify API 限流（每分钟）
THROTTLE_DIFY_TTL=60000
THROTTLE_DIFY_LIMIT=100

# 会话接口限流（每分钟）
THROTTLE_SESSION_TTL=60000
THROTTLE_SESSION_LIMIT=1000

# 工单接口限流（每分钟）
THROTTLE_TICKET_TTL=60000
THROTTLE_TICKET_LIMIT=1000

# ==================== 安全配置 ====================

# 加密密钥（生产环境必须设置！）
# ENCRYPTION_SECRET_KEY="your-32-char-secret-key-here!!!"
# ENCRYPTION_SALT="your-custom-salt"

# Dify API 默认查询限制
DIFY_DEFAULT_LIMIT=20

# 工单自动关闭配置
# 详细说明请参考: docs/工单自动关闭配置指南.md

# 启用/禁用自动关闭功能
# 值: true | false
# 默认: true
# 说明: 设置为 false 可以临时禁用自动关闭功能
ENABLE_AUTO_CLOSURE=true

# WAITING 状态工单超时时间（小时）
# 默认: 72（3天）
# 建议范围: 48-168（2-7天）
# 说明: 等待客服响应的工单超时时间
WAITING_TIMEOUT_HOURS=72

# IN_PROGRESS 状态工单（客服已回复）超时时间（小时）
# 默认: 24（1天）
# 建议范围: 12-72（0.5-3天）
# 说明: 客服已回复但玩家未响应的工单超时时间
REPLIED_TIMEOUT_HOURS=24
