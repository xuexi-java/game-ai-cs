
---

## 一、背景

### 1.1 需要支持的平台

| 平台                          | 技术特点                         |
| --------------------------- | ---------------------------- |
| Cocos Creator → Android APK | 原生 WebView，支持完整 JS Bridge    |
| Cocos Creator → iOS         | WKWebView，支持完整 JS Bridge     |
| 微信小程序                       | web-view 组件，仅支持加载远程 HTTPS 页面 |
| Flash 网页项目                  | swf 调用 js，通过 iframe 或弹窗打开网页  |

### 1.2 核心诉求

- 各平台接入成本低
    
- 后续维护成本低
    
- 代码复用率高
    
- H5 更新不依赖客户端发版
    

---

## 二、候选方案概述

### 方案 A：本地模式（测试阶段方案）

```
H5 资源打包进客户端
        ↓
file:// 协议加载
        ↓
所有网络请求通过 Bridge 代理
```

特点：

- H5 不直接访问网络
    
- 客户端承担请求代理、签名、上传等职责
    

---

### 方案 B：远程模式（推荐方案）

```
H5 部署在服务器
        ↓
https:// 加载
        ↓
H5 直接请求客服 API
        ↓
客户端仅提供认证参数
```

特点：

- H5 自主完成业务闭环
    
- 客户端职责最小化
    

---

### 方案 C：混合模式

```
APK / iOS → 本地模式
小程序 / Flash → 远程模式
```

特点：

- 同时存在两种运行契约
    
- 实际会演化为两套 H5 形态
    

---

## 三、方案对比分析

### 3.1 平台兼容性

| 平台        | 方案 A（本地） | 方案 B（远程） | 方案 C（混合） |
| --------- | -------- | -------- | -------- |
| Cocos APK | ✅        | ✅        | ✅ 本地     |
| Cocos iOS | ✅        | ✅        | ✅ 本地     |
| 微信小程序     | ❌        | ✅        | ✅ 远程     |
| Flash 网页  | ❌        | ✅        | ✅ 远程     |

**结论：方案 A 无法覆盖全部平台，直接排除。**

---

### 3.2 客户端开发工作量

|工作项|方案 B（远程）|方案 C（混合）|
|---|---|---|
|APK Bridge|2 个方法|6 个方法|
|iOS Bridge|2 个方法|6 个方法|
|小程序|URL 拼接|URL 拼接|
|Flash|URL 拼接|URL 拼接|

**方案 B 所需 Bridge 能力：**

- 获取认证参数
    
- 关闭 WebView
    

**方案 C 额外需要：**

- API 地址获取
    
- 请求签名
    
- HTTP 请求代理
    
- 文件上传代理
    

**结论：方案 B 客户端成本显著更低。**

---

### 3.3 H5 代码维护成本

| 维护项     | 方案 B（远程） | 方案 C（混合）    |
| ------- | -------- | ----------- |
| H5 代码份数 | 1 份      | 2 份         |
| 更新方式    | 服务器部署    | 服务器 + 客户端发版 |
| 逻辑一致性   | 天然一致     | 需人工保持同步     |

**结论：方案 B 维护成本最低。**

---

### 3.4 用户体验对比

| 体验项   | 方案 B（远程） | 方案 C（混合） |
| ----- | -------- | -------- |
| 首屏加载  | 需网络加载    | 原生端本地秒开  |
| 离线可用  | 不可用      | 原生端可打开界面 |
| 平台一致性 | 完全一致     | 可能存在差异   |

说明：客服 H5 体量通常较小，网络加载差距有限。

---

### 3.5 长期迭代能力

| 场景     | 方案 B（远程） | 方案 C（混合）     |
| ------ | -------- | ------------ |
| 修复 Bug | 即时生效     | 需等待发版        |
| 新增功能   | 仅部署服务器   | 可能需更新 Bridge |
| 紧急修复   | 分钟级      | 天级           |

**结论：方案 B 迭代效率显著更高。**

---

### 3.6 综合评分

| 评分项      | 权重   | 方案 B     | 方案 C     |
| -------- | ---- | -------- | -------- |
| 平台兼容性    | 30%  | 10       | 10       |
| 开发工作量    | 25%  | 9        | 5        |
| 维护成本     | 25%  | 9        | 4        |
| 用户体验     | 10%  | 7        | 8        |
| 迭代效率     | 10%  | 10       | 5        |
| **加权总分** | 100% | **9.05** | **6.35** |

---

## 四、是否需要开发 SDK

### 4.1 SDK 定义

SDK 用于封装客户端接入逻辑，减少游戏侧实现成本。

```
游戏代码
   ↓
CustomerService.open()
   ↓
SDK（WebView + Bridge）
   ↓
客服 H5
```

### 4.2 SDK 封装内容

- Android SDK（AAR）
    
- iOS SDK（Framework）
    
- JS SDK（小程序 / Flash）
    

### 4.3 SDK 优缺点对比

| 项   | 优点        | 缺点      |     |
| --- | --------- | ------- | --- |
| 接入  | 极简        | 需维护 SDK |     |
| 标准化 | 行为一致      | 灵活性降低   |     |
| 可控性 | Bridge 可控 | 需适配系统版本 |     |
| 成本  | 游戏侧低      | 平台侧高    |     |

### 4.4 是否值得开发 SDK

| 接入游戏数 | 建议   |
| ----- | ---- |
| 1–3   | 不需要  |
| 3–10  | 视人力  |
| 10+   | 强烈建议 |

**当前结论：暂不开发 SDK。**

---

## 五、代码复用分析

```
客服后端（100%）
        ↑
客服 H5（95%+）
        ↑
各平台 Bridge（0%）
        ↑
游戏签名接口（100%）
```

| 层级         | 复用率  | 说明      |
| ---------- | ---- | ------- |
| 客服后端       | 100% | 完全共用    |
| 客服 H5      | 95%+ | 仅参数来源差异 |
| 客户端 Bridge | 0%   | 语言差异    |
| 游戏签名接口     | 100% | 完全共用    |

---

## 六、最终建议

### 6.1 方案选择

**推荐方案 B：远程模式**

理由：

- 唯一覆盖全部平台
    
- 客户端成本最低
    
- H5 维护与迭代效率最高
    
- 代码复用率已达最优
    

### 6.2 SDK 策略

- 当前阶段不开发
    
- 接入规模扩大后再评估
    

### 6.3 实施步骤

1. 改造 H5：支持 URL / Bridge 双来源参数
    
2. 部署 HTTPS H5
    
3. 编写接入文档
    
4. 多平台验证
    

---

## 七、总结

|决策项|结论|
|---|---|
|接入方案|方案 B（远程）|
|是否开发 SDK|当前不需要|
|复用策略|H5 统一，客户端最小 Bridge|
|当前重点|H5 远程化改造|